<!DOCTYPE html>
	<html>
	<head>
		<title>Dynamic Canvas: basic animation</title>
	</head>

	<body>
		<h1>MY GAME NAME</h1>
		<canvas id="drawingZone" width="600" height="400">
		</canvas>
	<script>

window.onload=function() {	
	setup();
	start_game();
}




/* ---- SETUP ---- */

function setup() {
	setup_screen();
    setup_animation();
}

function setup_screen() {
	window.drawingZone = document.getElementById("drawingZone");
	window.ctx = drawingZone.getContext("2d");
	window.width = drawingZone.width;
	window.height = drawingZone.height;
}

function setup_animation() {

    window.duration=25;  // run animation every 0.2s
	window.nextTime=0;   // the next animation begin time
}

function snake_appear() {
	// snake parameters

    // The current (x,y) snake coordinate
	window.snake_x = rand(width);         
	window.snake_y = rand(height);     
    console.log(snake_x, snake_y);    
    window.snake_size=30;           
	// Animation speed/direction
    window.speedX=2;       // image will move at 1px per framerate 
    window.direction=1;    // 1==righward, -1==leftward
}


function apple_appear() {
    // The current (x,y) apple coordinate
	window.apple_x = rand(width);         
	window.apple_y = rand(height);     
    console.log(apple_x, apple_y);    
    window.apple_size = 10;           
}



/* ---- START GAME ---- */

function start_game() {
    snake_appear();
    apple_appear();
    requestAnimationFrame(game_loop);	
}



/* ---- GAME LOOP ---- */

function game_loop(currentTime) {

	process_motions();

	if (mustDraw(currentTime)) {
		// Have something to redraw: call requestAnimationFrame
		render_scene();
	}
	requestAnimationFrame(game_loop);
}

function mustDraw(currentTime) {
	// wait for nextTime to occur
	if (currentTime >= nextTime){
        // time hasn't elapsed so just return
		nextTime = currentTime + duration;
		return true;
    }
	return false;
}



/* ---- PROCESS MOTION ---- */

function process_motions() {
	// update snake position
	snake_x += speedX * direction;

	motions_behavior_rules();
}

function motions_behavior_rules() {
	// keep snake_x inside min & max
	if (snake_x < -snake_size ) { 
        snake_x = width + snake_size/2; 
    }
	else if (snake_x > width + snake_size/2 ) { 
        snake_x = -snake_size/2; 
    }
}



/* ---- DRAWINGS ---- */

function render_scene() {
	clear_scene();
	draw_scene_border();
	draw_sprites();
}

function draw_sprites() {
	draw_snake();
	draw_apple();
}

function draw_snake() {
	// add another rectangle every 1000ms
    ctx.fillStyle = "green";  
    ctx.fillRect(snake_x,snake_y,snake_size,snake_size);
	ctx.strokeRect(snake_x, snake_y, snake_size,snake_size); // snake border
}

function draw_apple() {
	// add another rectangle every 1000ms
    ctx.fillStyle = "red";  
    ctx.beginPath();
    ctx.arc( apple_x,apple_y,apple_size,0,Math.PI*2,false);
    ctx.fill();
}


function draw_scene_border() {
	ctx.strokeRect(0,0, width, height);
}

function clear_scene() {
    ctx.fillStyle = "#000";  
    ctx.fillRect(0, 0,  width, height);
}


/* ---- Utils to be DRY... */

let rand = (max) => Math.floor(Math.random()*max);
</script>

</body>
</html>	